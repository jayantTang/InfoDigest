# InfoDigest v2.0 需求设计文档

## 文档信息

- **项目名称**: InfoDigest v2.0
- **文档版本**: 1.0
- **创建日期**: 2025-01-18
- **文档类型**: 产品需求设计文档（PRD）
- **目标读者**: 产品经理、开发团队、设计师

---

## 1. 产品概述

### 1.1 产品定位

**InfoDigest v2.0** 是一个**智能投资监控系统**，通过自动化盯盘和AI分析，帮助个人投资者：

- 🔍 **实时监控**：自动监控投资标的的价格、新闻、事件
- 🤖 **智能分析**：LLM投资分析师提供深度分析和操作建议
- 📱 **主动推送**：在关键时刻及时提醒，不错过机会
- 💡 **个性化学习**：系统学习用户的投资风格，建议越来越精准

### 1.2 核心价值主张

```
"替代人工盯盘，让AI成为你的私人投资分析师"
```

**解决的核心问题：**
- ❌ 人工盯盘耗时耗力
- ❌ 信息过载，难以筛选重要内容
- ❌ 缺乏专业分析能力
- ❌ 错过关键时刻（策略触发、重大事件）

### 1.3 与v1.0的差异

| 维度 | v1.0 | v2.0 |
|------|------|------|
| **定位** | 新闻摘要应用 | 智能投资监控 |
| **用户角色** | 被动接收者 | 主动配置者 |
| **内容类型** | 新闻、股票摘要 | 投资分析+操作建议 |
| **推送方式** | 定时（每小时） | 双通道（即时+定时） |
| **个性化** | 无 | 完全个性化 |
| **支持资产** | 股票、ETF | 股票、ETF、加密货币、宏观 |
| **学习能力** | 无 | 有（反馈学习） |
| **用户配置** | 无 | 持仓、关注、策略、临时关注 |

---

## 2. 用户画像

### 2.1 目标用户

**主要用户：个人投资者**

- 年龄：25-45岁
- 职业：科技从业者、金融从业者、自由职业者
- 投资经验：有一定经验，但非专业
- 投资金额：$10K - $500K
- 投资风格：
  - 长期持有 + 短期交易结合
  - 关注科技、AI、加密货币等新兴领域
  - 希望控制风险，不想错过机会

**次要用户：**
- 加密货币投资者
- 日内交易者
- 理财新手（想学习）

### 2.2 用户痛点

**痛点1：信息过载**
```
"关注20多个标的，每天无数新闻和价格变化，
根本看不过来，担心错过重要信息"
```

**痛点2：缺乏分析能力**
```
"看到新闻不知道什么意思，
看到财报不知道怎么看，
想操作但拿不准主意"
```

**痛点3：时间有限**
```
"白天上班，没时间盯盘，
盘后才有时间看，
但那时市场已经反应了"
```

**痛点4：情绪化决策**
```
"大涨就想追，大跌就想割，
事后发现都是错的，
希望能有理性的建议"
```

### 2.3 用户需求

**核心需求：**
1. **不要错过重要信息**（机会、风险）
2. **给我专业的分析建议**（不是泛泛而谈）
3. **告诉我具体怎么做**（可执行的操作）
4. **记住我的情况**（持仓、策略、偏好）
5. **越用越懂我**（反馈学习）

**次要需求：**
1. 看起来专业（量化数据、图表）
2. 操作简单（配置一次，自动运行）
3. 推送不过载（可控制频率）
4. 支持我的资产（股票+加密货币）

---

## 3. 功能需求

### 3.1 功能架构

```
┌─────────────────────────────────────────┐
│          InfoDigest v2.0                │
├─────────────────────────────────────────┤
│                                         │
│  配置层                                 │
│  ├─ 持仓管理 (Portfolios)               │
│  ├─ 关注列表 (Watchlists)               │
│  ├─ 策略管理 (Strategies)               │
│  └─ 临时关注 (Temporary Focus)          │
│                                         │
│  监控层                                 │
│  ├─ 价格监控 (实时/定时)                │
│  ├─ 事件监控 (新闻/财报/公告)            │
│  ├─ 技术监控 (指标计算)                 │
│  └─ 策略监控 (触发条件判断)             │
│                                         │
│  分析层                                 │
│  ├─ LLM投资分析师                       │
│  ├─ 重要性评分引擎                     │
│  ├─ 推荐引擎                           │
│  └─ 学习引擎                           │
│                                         │
│  推送层                                 │
│  ├─ 即时推送 (策略触发/重大事件)        │
│  ├─ 定时推送 (每小时/每日)              │
│  └─ 查询推送 (用户主动)                 │
│                                         │
│  展示层                                 │
│  ├─ 推送通知                            │
│  ├─ 分析报告                            │
│  ├─ 数据可视化                         │
│  └─ 反馈界面                           │
│                                         │
└─────────────────────────────────────────┘
```

### 3.2 配置层功能

#### F1: 持仓管理 (Portfolios)

**功能描述：**
用户管理自己的投资组合，系统基于持仓提供个性化分析。

**详细需求：**

**F1.1 添加持仓**
- 用户可以添加多个持仓
- 每个持仓包含：
  - 标的符号（必填）
  - 资产类型（股票/ETF/加密货币/等）
  - 持仓数量（必填）
  - 平均成本（必填）
  - 交易所（可选）
- 系统自动计算：
  - 当前价格（实时更新）
  - 浮动盈亏
  - 总市值

**F1.2 编辑持仓**
- 修改持仓数量（加仓/减仓）
- 修改平均成本
- 手动更新（如果系统自动获取不准）

**F1.3 删除/清仓**
- 标记为"已清仓"
- 保留历史记录
- 停止监控和推送

**F1.4 监控设置**
每个持仓可以设置告警：
- 价格突破（高于/低于某价格）
- 涨跌幅超过X%
- 成交量异常
- 财报发布日提醒

**优先级：** P0（必须有）

---

#### F2: 关注列表 (Watchlists)

**功能描述：**
用户跟踪未持仓但感兴趣的标的。

**详细需求：**

**F2.1 添加关注**
- 选择标的（股票/ETF/加密货币/板块）
- 选择关注原因：
  - 潜在买入
  - 竞品跟踪
  - 板块观察
  - 投机性关注
- 添加备注

**F2.2 关注维度**
可以选择关注哪些方面：
- ✅ 价格监控
- ✅ 新闻监控
- ✅ 技术指标
- ✅ 板块动向

**F2.3 优先级设置**
- 设置关注优先级（1-10）
- 影响推送和分析的深度

**F2.4 从关注转持仓**
- 一键将关注的标的转为持仓
- 自动带入历史数据

**优先级：** P0（必须有）

---

#### F3: 策略管理 (Strategies)

**功能描述：**
用户设置投资策略，系统监控并在触发时推送建议。

**详细需求：**

**F3.1 创建策略**
- 策略名称（如："NVDA突破加仓"）
- 选择标的
- 设置触发条件：

  **价格条件：**
  - 价格高于/低于某值
  - 涨跌幅超过X%

  **技术条件：**
  - RSI高于/低于某值（超买/超卖）
  - MACD金叉/死叉
  - 突破某个技术位

  **时间条件：**
  - 某个日期/时间（如：财报发布后）

  **事件条件：**
  - 重大新闻（LLM评分>=85）
  - 财报发布
  - 政策变化

- 设置操作建议：
  - 操作类型：买入/卖出/持有/调整仓位
  - 具体数量或百分比
  - 理由说明

**F3.2 策略优先级**
- 设置优先级（1-10）
- 影响推送的紧急程度
- 高优先级策略触发时立即推送

**F3.3 策略状态管理**
- 激活/暂停策略
- 修改策略条件
- 删除策略
- 查看触发历史

**F3.4 策略模板**
提供常用策略模板：
- "突破新高加仓"
- "跌破均线止损"
- "财报前后观望"
- "技术指标反转"

**优先级：** P1（重要）

---

#### F4: 临时关注 (Temporary Focus)

**功能描述：**
用户设置临时的、有针对性的监控任务。

**详细需求：**

**F4.1 创建临时关注**
- 输入标题（如："关注AMD财报对NVDA的影响"）
- 设置监控目标：
  - 相关标的（多个）
  - 关键词（如："财报"、"竞争"）
  - 时间范围（今天/本周/持续）
- 设置关注重点：
  - ✅ 新闻影响分析
  - ✅ 价格反应对比
  - ✅ 关联性分析
  - ✅ 板块效应

**F4.2 有效期管理**
- 设置过期时间（自动失效）
- 过期前提醒："这个临时关注即将过期"
- 过期后询问：继续关注/转为长期/结束

**F4.3 状态展示**
在App显示：
```
🔍 服务器正在关注... (2)
• 关注AMD财报对NVDA的影响
• 监控美联储讲话对科技股的影响
```

**F4.4 结果通知**
- 临时关注期间，有相关发现时推送
- 过期后发送总结报告

**优先级：** P1（重要）

---

### 3.3 监控层功能

#### F5: 价格监控

**功能描述：**
系统定期（每小时）采集用户关注标的价格数据。

**详细需求：**

**F5.1 实时价格采集**
- 从Alpha Vantage采集股票、ETF价格
- 从CoinGecko采集加密货币价格
- 更新频率：每小时（可配置）
- 保存到数据库（分区表，按月）

**F5.2 价格数据处理**
- 计算涨跌幅
- 计算成交量变化
- 检测异常波动：
  - 单日涨跌 > 5%
  - 成交量 > 平均2倍
  - 价格突破关键技术位

**F5.3 历史数据**
- 保留2年历史数据
- 提供技术分析所需的数据窗口
- 支持不同时间粒度（日/周/月）

**优先级：** P0（必须有）

---

#### F6: 新闻和事件监控

**功能描述：**
系统采集新闻、财报、公告等事件，评估重要性。

**详细需求：**

**F6.1 新闻采集**
- 从NewsAPI采集科技新闻
- 过滤低质量新闻（标题="[removed]"）
- 每小时采集一次
- 按重要性评分存储

**F6.2 事件分类**
- 财报（earnings）
- 并购（merger）
- 产品发布（product）
- 监管政策（regulation）
- 宏观事件（macro）

**F6.3 重要性评分**
LLM评估新闻重要性（0-100分）：
- 影响范围（0-30分）
- 时效性（0-25分）
- 相关性（0-20分）
- 独特性（0-15分）
- 用户兴趣（0-10分）

**F6.4 关联标的识别**
- 自动识别新闻中提到的股票、加密货币
- 关联到用户持仓/关注
- 触发个性化分析

**优先级：** P0（必须有）

---

#### F7: 技术指标计算

**功能描述：**
系统计算和缓存常用技术指标。

**详细需求：**

**F7.1 趋势指标**
- SMA（5, 10, 20, 50日简单移动平均）
- EMA（12, 26日指数移动平均）
- MACD（DIF, DEA, 柱状图）

**F7.2 动量指标**
- RSI（14日相对强弱指标）
- 随机指标（Stochastic）

**F7.3 波动指标**
- 布林带（上轨、中轨、下轨）
- ATR（平均真实波幅）

**F7.4 计算频率**
- 每小时更新一次
- 缓存到technical_indicators表
- 避免重复计算

**F7.5 指标解读**
LLM基于技术指标给出分析：
```
RSI = 68 → 偏强，但未超买
MACD金叉 → 短期上涨趋势
突破布林带上轨 → 可能回调
```

**优先级：** P1（重要）

---

#### F8: 策略监控

**功能描述：**
系统持续监控用户设置的策略，触发时推送。

**详细需求：**

**F8.1 实时监控**
- 每小时检查所有激活的策略
- 判断触发条件是否满足
- 记录触发历史

**F8.2 触发判断**
- 价格策略：对比当前价格和条件
- 技术策略：检查技术指标
- 时间策略：检查日期时间
- 事件策略：检查相关事件

**F8.3 推送决策**
```
IF 策略优先级 >= 8:
    立即推送
ELSE IF 重要性评分 >= 85:
    立即推送
ELSE:
    纳入定时分析
```

**F8.4 触发历史**
- 记录每次触发
- 关联市场数据
- 关联分析报告
- 等待用户反馈

**优先级：** P0（必须有）

---

### 3.4 分析层功能

#### F9: LLM投资分析师

**功能描述：**
LLM扮演私人投资分析师，为用户提供深度分析。

**详细需求：**

**F9.1 角色设定**
```
你是一位资深的投资分析师，专门为个人投资者提供：

1. 数据驱动的分析
   - 所有结论必须有量化数据支撑
   - 避免主观臆断和模糊表达
   - 用数字说话

2. 个性化建议
   - 充分理解用户的持仓和策略
   - 分析时站在用户的角度
   - 建议要具体可执行

3. 多维度思考
   - 宏观、行业、公司、市场
   - 板块关联
   - 竞争对手

4. 风险意识
   - 每个建议评估风险
   - 说明不确定性
   - 给出不同情景应对

5. 板块关联思维
   - 产业链上下游
   - 竞争对手
   - 相关性分析
```

**F9.2 分析框架**

每份分析包含4个section：

**Section 1: 持仓分析**
```
- 当前价格、盈亏情况
- 成交量、换手率
- 技术面（RSI、MACD等）
- 持仓建议
```

**Section 2: 事件影响分析**
```
- 事件描述
- 直接影响（对持仓标的）
- 间接影响（对板块、竞品）
- 时间维度（短期/中期/长期）
- 风险评估
```

**Section 3: 板块分析**
```
- 板块涨跌
- 估值水平（PE分位数）
- 资金流向
- 领涨/领跌股
- 相关性分析
```

**Section 4: 操作建议**
```
- 具体操作（买入/卖出/持有）
- 触发条件（如果满足...）
- 数量建议
- 风险提示
- 置信度
```

**F9.3 输出格式**
```json
{
  "summary": "150字摘要",
  "sections": [
    {
      "type": "position_analysis",
      "title": "持仓分析",
      "content": "Markdown格式",
      "data": { /* 量化数据 */ },
      "keyPoints": ["要点1", "要点2"]
    }
    // ... 其他sections
  ],
  "visualizations": [
    {
      "type": "chart",
      "title": "价格走势图",
      "data": "图表URL或数据"
    }
  ],
  "confidence": 75,  // 可信度
  "urgency": "normal"  // low/normal/high
}
```

**优先级：** P0（必须有）

---

#### F10: 个性化学习

**功能描述：**
系统通过用户反馈学习，越来越懂用户。

**详细需求：**

**F10.1 反馈收集**

**操作反馈：**
```
服务器推送："建议加仓NVDA 20股"
用户点击：
[已执行] → 填写实际操作
[未执行] → 选择原因（没资金/改变主意/其他）
```

**内容反馈：**
```
每条推送底部：
👍 有用
👎 没用
💬 详细反馈
```

**F10.2 用户画像更新**

根据反馈更新用户画像：
```json
{
  "riskProfile": "保守 | 中性 | 激进",
  "fundingStatus": "充足 | 有限",
  "decisionStyle": "快速执行 | 等待确认",
  "usefulAnalysis": ["技术面", "板块分析"],
  "suggestionAcceptanceRate": 0.75,
  "confidenceCalibration": {
    "llm_said": 80,
    "user_executed": 60,
    "adjustment": -20
  }
}
```

**F10.3 学习策略**
```
前10次反馈：快速学习基础偏好
后续反馈：持续微调和校准
```

**F10.4 画像可见性**
用户可以在设置中查看：
```
我的投资画像 🤖
├─ 风险偏好: 中性
├─ 决策风格: 喜欢等待确认
├─ 偏好分析: 技术面、板块分析
└─ 建议接受率: 75%

[重置画像] [手动调整]
```

**优先级：** P1（重要）

---

### 3.5 推送层功能

#### F11: 双通道推送

**功能描述：**
根据紧急程度选择推送方式。

**详细需求：**

**F11.1 即时推送通道**

**触发条件：**
1. 策略触发（优先级>=8）
2. 重大事件（LLM评分>=85分）
3. 用户临时关注的关键事件

**推送内容：**
```
🚨 [策略触发] NVDA 突破 $900

当前价格: $905 (+1.70%)
成交量: 3200万 (高于平均)

建议: 加仓 20股 @ $905
理由: 技术突破确认，成交量配合

[查看详情]
```

**特点：**
- 短小精悍
- 立即推送
- 明确操作建议

**F11.2 定时推送通道**

**触发时间：**
- 每小时整点
- 每天21:00（每日摘要）

**推送内容：**
```
📊 投资监控日报 - 21:00
[休市中] 明早9:30开盘

我的持仓:
NVDA $895 (+1.7%) ✅ 浮盈$1500
TSLA $248 (-0.8%) ❌ 浮亏$100

🔍 临时关注:
AMD财报影响分析 → 建议: 观望

📊 半导体板块: +0.5%
估值: 28.5倍 (历史65%分位)
资金: 净流入+$2.3亿

[查看完整分析]
```

**特点：**
- 内容全面
- 包含多个分析
- 可视化图表

**F11.3 推送控制**

用户可以设置：
- 推送频率：正常 | 极简 | 全部
- 免打扰时间：22:00 - 08:00
- 推送类型：股票 | 加密货币 | 宏观

**优先级：** P0（必须有）

---

#### F12: 推送内容要求

**功能描述：**
推送内容必须满足特定要求。

**详细需求：**

**F12.1 必须有量化信息**
```
✅ "NVDA涨5.2%，成交量2800万，是平时的2.3倍"
✅ "RSI突破70，进入超买区间"
❌ "NVDA今天涨了" (太泛泛)
```

**F12.2 必须有可视化**
```
- 价格走势图（带关键点标注）
- 技术指标图表
- 资金流向图
- 板块涨跌分布
```

**F12.3 必须有投资分析**
```
- 持仓建议：持有/加仓/减仓/观望
- 风险提示：当前风险等级
- 操作时机：具体的价格和条件
- 理由：数据支撑
```

**F12.4 长度选项**
- 完整版：2000字，详细分析
- 精简版：500字，核心要点
- 用户在设置中切换

**优先级：** P0（必须有）

---

### 3.6 加密货币功能

#### F13: 加密货币监控

**功能描述：**
加密货币有特殊性，需要单独的UI和监控逻辑。

**详细需求：**

**F13.1 监控的币种**
```
主流币（市值前10）:
- BTC, ETH, BNB, SOL, XRP, ADA...

知名小币:
- Meme币: PEPE, SHIB, DOGE, FLOKI, BONK
- AI币: FET, AGIX, RNDR
- 热门新币（市值前20）
```

**F13.2 特殊监控维度**

**链上数据：**
- 巨鲸动向（大额转账）
- 交易所流入/流出（抛压/吸筹）
- 活跃地址数
- 交易数量

**情绪指标：**
- 恐惧贪婪指数（0-100）
- 社交媒体提及度
- 资金费率（合约）
- 多空比
- 持仓量（Open Interest）

**F13.3 24/7监控**
```
美股休市时:
• 加密货币继续监控
• 正常推送重要变化
• 标注【加密市场开放中】
```

**F13.4 风险提示**
```
Meme币推送时标注：
⚠️ 极高风险
- 波动性是股票3-5倍
- 可能单日跌50%
- 注意风险
```

**F13.5 独立UI**
```
Tab: 加密货币
├─ 我的持仓
├─ 关注列表
├─ 板块监控 (Meme/AI/DeFi)
└─ 市场概况
```

**优先级：** P1（重要）

---

### 3.7 板块分析功能

#### F14: 深入板块分析

**功能描述：**
不仅分析单个标的，还要分析整个板块和关联性。

**详细需求：**

**F14.1 板块数据**

**基本信息：**
- 板块名称、ETF代表
- 包含的股票数量
- 总市值

**估值水平：**
- 平均PE、PB
- 历史分位数（当前位置）
- 相对市场的估值（溢价/折价）

**涨跌分析：**
- 板块涨跌幅
- 领涨股（涨跌原因）
- 领跌股
- 涨跌家数比

**资金流向：**
- 净流入/流出
- 机构资金动向
- 散户资金动向

**F14.2 板块关联分析**

**产业链分析：**
```
半导体板块:
上游: 设备商(ASML +1.2%), 材料(TER +0.8%)
中游: 设计(NVDA +1.7%), 代工(TSM -0.3%)
下游: 消费电子(AAPL +0.5%), 汽车(TSLA -0.2%)
```

**相关性分析：**
- 板块内个股相关系数
- 与其他板块的相关性
- Beta系数（相对大盘）

**相对强弱：**
- vs 标普500
- vs 科技板块
- 在所有板块中的排名

**F14.3 数据来源**
```
✅ ETF数据（SOXX, XLK等）
✅ 新闻和财报（多角度）
✅ 证券研究报告（专业分析）
❌ 不能只用ETF
```

**优先级：** P1（重要）

---

### 3.8 反馈和学习功能

#### F15: 用户反馈系统

**功能描述：**
用户可以对推送和分析给出反馈。

**详细需求：**

**F15.1 操作反馈**
```
推送："建议加仓NVDA 20股"

用户操作:
[已执行]
  → 填写表单：
    - 实际价格: $903
    - 实际数量: 20股
    - 执行时间: 刚才
    - 备注: 相信突破
  → 提交后更新持仓
  → 系统记住：用户接受建议

[未执行]
  → 选择原因:
    • 没有资金
    • 改变主意
    • 看到其他信息
    • 其他: _______
  → 系统学习：用户为什么没执行
```

**F15.2 内容反馈**
```
每条分析底部:
👍 有用 (12人)
👎 没用 (2人)
💬 反馈
🔖 收藏

点击"反馈":
- 这个分析很有帮助
- 信息不够详细
- 操作建议不合理
- 数据有误
- 其他: _______
```

**F15.3 反馈的使用**
```
1. 更新用户画像
   - 风险偏好
   - 决策风格
   - 喜欢的分析类型

2. 校准LLM判断
   - 如果LLM说置信度80%，但用户只执行60%
   - 说明LLM高估了，下次调整

3. 个性化推荐
   - 喜欢技术分析 → 多给技术指标
   - 喜欢基本面 → 多给财报数据
```

**F15.4 多设备同步**
```
iPhone反馈"已加仓"
→ 立即同步到服务器
→ iPad立即看到新持仓
```

**优先级：** P1（重要）

---

## 4. 非功能需求

### 4.1 性能需求

**NFR1: 推送延迟**
```
即时推送:
- Level 1（策略触发）: < 5秒
- Level 2（重大事件）: < 30秒
- Level 3（定时）: 整点后1分钟内
```

**NFR2: API响应时间**
```
查询API:
- p50 < 200ms
- p95 < 500ms
- p99 < 1s

配置API:
- < 300ms
```

**NFR3: 数据采集**
```
每小时数据采集:
- 所有用户关注标的
- 并发采集
- 5分钟内完成
```

**NFR4: LLM调用**
```
重要性评分:
- p50 < 3秒
- p95 < 10秒

深度分析:
- p50 < 15秒
- p95 < 30秒
```

### 4.2 可用性需求

**NFR5: 系统可用性**
```
目标: 99.5% (每月停机< 3.6小时)
计划内维护: 提前通知
```

**NFR6: 数据准确性**
```
价格数据: 延迟< 5分钟
技术指标: 计算准确率> 99.9%
新闻来源: 可靠来源，过滤谣言
```

**NFR7: 推送可靠性**
```
推送到达率: > 95%
重复推送: < 1%
```

### 4.3 安全性需求

**NFR8: 数据隐私**
```
- 用户数据完全隔离
- 配置信息加密存储
- API密钥不暴露
- 不记录敏感信息（密码、私钥）
```

**NFR9: API安全**
```
- API认证（device token）
- 速率限制
- 防止滥用
```

### 4.4 可扩展性需求

**NFR10: 用户规模**
```
支持: 1000-10000用户
扩展到: 100000用户
```

**NFR11: 标的数量**
```
支持: 1000个不同标的
扩展到: 10000个
```

### 4.5 维护性需求

**NFR12: 日志和监控**
```
- 完整的操作日志
- 性能监控
- 错误追踪
- 异常报警
```

---

## 5. 数据需求

### 5.1 必须数据（P0）

**价格数据：**
```
实时报价:
- 当前价
- 涨跌幅
- 成交量
- 日内高低点

历史数据:
- 52周高低
- YTD收益
- 月度收益
```

**技术指标：**
```
核心指标:
- SMA, EMA
- RSI
- MACD
- Bollinger Bands
```

**新闻数据：**
```
- 标题
- 描述
- 来源
- 发布时间
- 相关标的
```

### 5.2 重要数据（P1）

**基本面数据：**
```
估值指标: PE, PB, PS
盈利能力: EPS, ROE, ROA
成长性: 营收增长、利润增长
```

**板块数据：**
```
板块涨跌
估值水平
资金流向
成分股表现
```

**加密货币数据：**
```
价格和市值
链上数据（巨鲸、流入流出）
情绪指标（恐惧贪婪）
合约数据（资金费率、多空比）
```

### 5.3 可选数据（P2）

**高级指标：**
```
期权数据（Put/Call Ratio）
VIX指数
分析师评级
社交情绪
```

**另类数据：**
```
卫星图像（零售、建筑）
信用卡数据（消费）
搜索趋势（Google Trends）
```

---

## 6. 交互流程

### 6.1 首次使用流程

```
1. 用户下载App
   ↓
2. 注册设备（推送权限）
   ↓
3. 配置向导（可跳过）:
   - 添加持仓（如果有）
   - 添加关注列表
   - 设置策略（可选）
   ↓
4. 系统开始监控
   ↓
5. 接收推送和分析
   ↓
6. 给出反馈（可选）
   ↓
7. 系统学习，越来越精准
```

### 6.2 日常使用流程

```
被动模式（推荐）:
1. 系统监控（后台）
2. 触发条件/定时分析
3. 推送通知
4. 用户查看详情
5. 根据建议操作（可选）
6. 反馈结果（可选）

主动模式:
1. 用户打开App
2. 下拉刷新
3. 查看最新分析
4. 深入了解标的详情
```

### 6.3 配置变更流程

```
用户配置:
- 添加持仓/关注
- 修改策略
- 设置临时关注
   ↓
系统同步到服务器
   ↓
下次分析时生效
   ↓
推送考虑新配置
```

### 6.4 反馈流程

```
收到推送 "建议加仓NVDA"
   ↓
用户点击 [已执行]
   ↓
填写实际操作:
- 价格: $903
- 数量: 20股
   ↓
提交反馈
   ↓
系统更新:
- 持仓: NVDA 120股 @ $880
- 画像: 接受建议，风险偏好中性
   ↓
下次分析:
- 基于新持仓
- 理解用户执行了这个建议
- 建议更符合实际情况
```

---

## 7. 界面设计要求

### 7.1 iOS界面结构

```
Tab 1: 监控
├─ 我的持仓
├─ 关注列表
└─ 策略管理

Tab 2: 分析
├─ 最新分析
├─ 历史记录
└─ 标的详情

Tab 3: 加密货币
├─ 我的持仓
├─ 关注列表
├─ 板块监控 (Meme/AI/DeFi)
└─ 市场概况

Tab 4: 设置
├─ 推送设置
├─ 分析偏好
├─ 我的画像
└─ 关于
```

### 7.2 配置界面

**持仓配置页面：**
```
我的持仓 (3)

┌─────────────────────────┐
│ NVDA                    │
│ 100股 @ $880            │
│ 现价: $895 (+1.70%)    │
│ 浮盈: $1,500            │
│                         │
│ 📊 监控中:              │
│ ✓ 价格突破$900           │
│ ✓ 跌破$800止损           │
│                         │
│ [编辑] [添加持仓]        │
└─────────────────────────┘
```

**策略管理页面：**
```
我的策略 (2)

┌─────────────────────────┐
│ 🎯 NVDA突破加仓策略 [活跃]│
│ ──────────────────────  │
│ 条件:                   │
│ • NVDA突破$900          │
│ • RSI < 70              │
│                         │
│ 操作:                   │
│ • 加仓20股              │
│                         │
│ 优先级: ⭐⭐⭐⭐⭐ (9/10)│
│                         │
│ [编辑] [暂停] [删除]     │
└─────────────────────────┘

[+ 创建策略]
```

### 7.3 分析展示页面

**推送通知展开：**
```
┌─────────────────────────┐
│ 🚨 策略触发提醒         │
├─────────────────────────┤
│                         │
│ NVDA 突破 $900          │
│                         │
│ 当前价格: $905          │
│ 涨跌幅: +1.70%         │
│ 成交量: 3200万 (高于平均)│
│                         │
│ 触发条件:               │
│ ✅ 价格突破 $900        │
│ ✅ RSI 65 (非超买)      │
│                         │
│ 💡 操作建议             │
│ 加仓 20股 @ $905        │
│                         │
│ 理由:                   │
│ 技术突破确认，成交量配合 │
│                         │
│ 风险: 中等              │
│ 置信度: 75%             │
│                         │
│ [标记已读] [查看详情]   │
└─────────────────────────┘
```

**详情页：**
```
┌─────────────────────────┐
│ NVDA - 英伟达           │
├─────────────────────────┤
│ [24小时走势图]          │
│ [技术指标] [资金流向]   │
│                         │
│ 📊 技术分析             │
│ 趋势: 上升通道          │
│ 支撑: $880, $850       │
│ 阻力: $900, $920       │
│ RSI: 65 (健康)         │
│                         │
│ 🏢 基本面               │
│ 市盈率: 65倍 (高估值)  │
│ 分析师: 38买 8持有 2卖 │
│                         │
│ 🔗 板块与关联           │
│ 半导体: +0.5%          │
│ AMD: +3.2%            │
│ TSM: +0.8%            │
│                         │
│ 📰 相关新闻             │
│ 1. AMD财报超预期...     │
│ 2. 微软宣布...         │
│                         │
│ 💬 AI分析师观点         │
│ [完整分析报告]          │
│                         │
│ ⚙️ 你的配置             │
│ 持仓: 100股 @ $880     │
│ 浮盈: +$1,500          │
│ 策略: 突破$900加仓     │
│                         │
│ [编辑策略] [添加提醒]   │
└─────────────────────────┘
```

### 7.4 加密货币UI

```
┌─────────────────────────┐
│ 加密货币                │
├─────────────────────────┤
│                         │
│ 我的加密货币 (2)        │
│                         │
│ BTC 0.5个 @ $45000      │
│ 现价: $46500 (+3.3%)   │
│ 浮盈: $750              │
│                         │
│ [24/7监控中]            │
│                         │
│ PEPE 1M枚 @ $0.0000012  │
│ 现价: $0.0000018        │
│ 浮盈: $600 (+50%)       │
│                         │
│ ⚠️ 极高风险            │
│                         │
│ ─────────────────────  │
│                         │
│ 🔍 临时关注 (1)         │
│ "关注BTC减半事件"      │
│                         │
│ ─────────────────────  │
│                         │
│ 📊 Meme板块             │
│ 今日: +12.5%          │
│ 领涨: PEPE +45%       │
│                         │
│ [查看板块详情 →]       │
└─────────────────────────┘
```

---

## 8. 约束条件

### 8.1 技术约束

**T1: LLM成本**
- DeepSeek API: ¥1/百万tokens (输入), ¥2/百万tokens (输出)
- 需要控制prompt长度
- 缓存常见分析结果

**T2: API限制**
- Alpha Vantage: 免费5次/分钟
- CoinGecko: 免费10-30次/分钟
- NewsAPI: 免费100次/天

**T3: iOS推送限制**
- 推送通知长度: title 50字, body 180字
- 需要详情在App内查看

**T4: 数据延迟**
- 免费API可能有15-20分钟延迟
- 需要标注数据延迟时间

### 8.2 业务约束

**B1: 不提供自动交易**
- 只给建议，用户自己执行
- 不连接券商API

**B2: 不保证收益**
- 明确声明：建议仅供参考
- 不承担投资损失

**B3: 监管合规**
- 不提供投资顾问服务（需要牌照）
- 明确定位为"信息工具"

### 8.3 用户约束

**C1: 用户配置要求**
- 用户必须配置才能使用
- 至少配置持仓或关注

**C2: 反馈自愿**
- 不强制反馈
- 但反馈后更精准

---

## 9. 验收标准

### 9.1 功能验收

**V1. 用户配置**
- [ ] 可以添加/编辑/删除持仓
- [ ] 可以添加/编辑/删除关注
- [ ] 可以创建/暂停/删除策略
- [ ] 可以创建临时关注

**V2. 数据监控**
- [ ] 每小时采集价格数据
- [ ] 每小时采集新闻数据
- [ ] 实时监控策略触发条件
- [ ] 采集技术指标

**V3. 分析生成**
- [ ] LLM生成4个section的分析
- [ ] 包含量化数据
- [ ] 包含可视化图表
- [ ] 提供具体操作建议

**V4. 推送服务**
- [ ] 策略触发时立即推送
- [ ] 重大事件立即推送
- [ ] 每小时定时推送
- [ ] 每天21:00摘要推送

**V5. 反馈学习**
- [ ] 可以反馈"已执行"并填写操作
- [ ] 可以给出内容反馈
- [ ] 用户画像可见
- [ ] 反馈后建议更精准

**V6. 加密货币**
- [ ] 支持主流币种监控
- [ ] 支持Meme币监控
- [ ] 展示链上数据
- [ ] 展示情绪指标
- [ ] 24/7监控

### 9.2 性能验收

**P1. 响应时间**
- [ ] 即时推送延迟 < 5秒 (p95)
- [ ] API响应 < 500ms (p95)
- [ ] 数据采集5分钟内完成

**P2. 可用性**
- [ ] 系统可用性 > 99.5%
- [ ] 推送到达率 > 95%

**P3. 数据准确性**
- [ ] 价格数据延迟 < 5分钟
- [ ] 技术指标计算准确

### 9.3 用户体验验收

**U1. 易用性**
- [ ] 配置流程简单（5分钟内完成）
- [ ] 推送内容清晰易懂
- [ ] 分析报告结构化

**U2. 个性化**
- [ ] 基于用户配置推送
- [ ] 反馈后建议更精准
- [ ] 用户画像准确

**U3. 可控性**
- [ ] 可以调整推送频率
- [ ] 可以设置免打扰
- [ ] 可以编辑配置

---

## 10. 开发优先级

### Phase 1: 基础设施 (Week 1-2)
```
P0 - 必须有:
[x] 数据库Schema设计
[ ] 执行迁移脚本
[ ] 用户配置API (portfolios, watchlists)
[ ] 设备注册流程更新
```

### Phase 2: 数据采集 (Week 2-3)
```
P0 - 必须有:
[ ] 价格数据采集 (Alpha Vantage)
[ ] 加密货币采集 (CoinGecko)
[ ] 新闻采集 (NewsAPI)
[ ] 数据存储和更新
```

### Phase 3: 监控引擎 (Week 3-4)
```
P0 - 必须有:
[ ] 策略监控逻辑
[ ] 触发判断
[ ] 技术指标计算
[ ] 重要性评分引擎
```

### Phase 4: LLM分析 (Week 4-6)
```
P0 - 必须有:
[ ] LLM投资分析师实现
[ ] 4-section分析生成
[ ] 个性化prompt生成
[ ] 分析报告优化
```

### Phase 5: 推送服务 (Week 6-7)
```
P0 - 必须有:
[ ] 双通道推送实现
[ ] 推送内容格式化
[ ] 推送优先级管理
[ ] 休市时间处理
```

### Phase 6: 反馈学习 (Week 7-8)
```
P1 - 重要:
[ ] 反馈收集界面
[ ] 用户画像更新
[ ] 学习算法实现
```

### Phase 7: iOS客户端v2 (Week 6-9)
```
P0 - 必须有:
[ ] 配置界面
[ ] 推送展示优化
[ ] 分析报告展示
[ ] 反馈界面

P1 - 重要:
[ ] 加密货币单独Tab
[ ] 数据可视化
[ ] 用户画像展示
```

---

## 11. 成功指标

### 11.1 用户指标
- 用户注册数: 100+ (3个月内)
- DAU: 30+
- 推送打开率: > 60%
- 反馈率: > 20%

### 11.2 业务指标
- 策略触发准确率: > 70%
- 建议接受率: > 50%
- 用户满意度: > 4.0/5.0

### 11.3 技术指标
- 系统可用性: > 99.5%
- 推送延迟: < 5秒 (p95)
- API响应: < 500ms (p95)

---

## 12. 风险和挑战

### 12.1 技术风险

**R1: LLM输出不稳定**
- 缓解: 降级到简单模式
- 缓解: 多次生成取最佳

**R2: API限流**
- 缓解: 使用多个数据源
- 缓解: 缓存常用数据

**R3: 性能瓶颈**
- 缓解: 异步任务队列
- 缓解: Redis缓存

### 12.2 业务风险

**R4: 用户依赖系统建议**
- 缓解: 明确声明"仅供参考"
- 缓解: 强调风险，不保证收益

**R5: 监管风险**
- 缓解: 明确定位为"信息工具"
- 缓解: 不提供投资顾问服务

### 12.3 产品风险

**R6: 用户不配置就不使用**
- 缓解: 提供示例配置
- 缓解: 引导用户首次配置

**R7: 反馈太少，学不会**
- 缓解: 前10次引导反馈
- 缓解: 即使不反馈也提供合理建议

---

## 附录

### A. 术语表

| 术语 | 解释 |
|------|------|
| 持仓 (Portfolio) | 用户实际持有的资产 |
| 关注列表 (Watchlist) | 用户关注但未持有的资产 |
| 策略 (Strategy) | 用户设置的交易规则 |
| 临时关注 (Temporary Focus) | 短期的、针对性的监控任务 |
| 重要事件 | LLM评分>=85的新闻或事件 |
| 策略触发 | 用户的交易条件被满足 |
| 深度报告 | 4-section的详细分析 |

### B. 参考资料

- Alpha Vantage API文档
- CoinGecko API文档
- NewsAPI文档
- DeepSeek API文档
- PostgreSQL文档

### C. 变更历史

| 版本 | 日期 | 变更内容 | 作者 |
|------|------|----------|------|
| 1.0 | 2025-01-18 | 初始版本 | Claude |

---

**文档结束**
